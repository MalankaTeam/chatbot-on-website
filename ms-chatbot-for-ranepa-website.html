<!DOCTYPE html>
<html>

<head>
	<title>chat bot test</title>

    <!-- THIS IS START FOR HEADER BLOCK.   ЭТО НАЧАЛО ДЛЯ БЛОКА В ШАПКЕ СТРАНИЦЫ -->
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.botframework.com/botframework-webchat/latest/botchat.css" rel="stylesheet" />

	<style>
		.call-button {
			position: fixed;
			bottom: 0px;
			right: 0px;
			width: 80px;
			height: 80px;
			z-index: 500;
		}

		@media only screen and (max-width: 600px) {
			.call-button {
				bottom: 0px;
			}
		}

		.call-button a {
			display: inline-block;
			margin-left: -5px;
			margin-right: 15px;
			padding-left: 25px;
			padding-right: 15px;
		}

		.phone-callback-icon {
			width: 60px;
			height: 60px;
			padding-top: 7px;
			background-color: #951a1d;
			box-shadow: 0px 0px 3px 4px #ff7b7b;
			animation: move-shadow 5s infinite;
			border-radius: 60px;
            cursor: pointer;
		}

        .phone-callback-icon a img {
            width: 55px;
            margin-left: -17px;
            margin-top: -3px;
        }

		.sended-callback {
			text-align: center;
		}

		.error-info {
			color: #ff0000;
		}

		#chat-icon-pic {
			margin-top: 6px;
			color: white;
		}

		#chat-bot-ms iframe {
			opacity: 0.5;
			border: 0;
			position: absolute;
			bottom: 95px;
			right: 5px;
			z-index: 500;
		}

        #chatbot-container {
            position: absolute;
            bottom: 95px;
            width: 1px;
            height: 1px;
            right: 5px;
			z-index: 500;
        }

		#chat-bot-ms #chat-bot-bg {
			height: 590px;
			width: 330px;
			background-color: #fcfcfc;
			position: absolute;
			bottom: 95px;
			right: 5px;
			display: none;
			box-shadow: 0px 0px 3px 4px #e9e9e9;
			z-index: 500;
		}

        /** Bot container **/
        .wc-header {
            background-color: #990000;
        }

        .wc-message-from-me .wc-message-content {
            background-color: #a30a0d;
            color: #ffffff;
        }

        .wc-message-from-me svg.wc-message-callout path {
            fill: #a30a0d;
        }

        .wc-adaptive-card {
            width: 250px;
        }
	</style>
    <!-- THIS IS END FOR HEADER BLOCK.   ЭТО КОНЕЦ ДЛЯ БЛОКА В ШАПКЕ СТРАНИЦЫ -->

</head>

<body>
	<h1>hello</h1>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>
	<h2>hello</h2>

    <!-- THIS IS START FOR HTML-BLOCK IN THE PAGE.         ЭТО НАЧАЛО БЛОКА ДЛЯ ВСТАВКИ В HTML-блок страницы -->
	<div class="call-button">
		<div class="big-triangle-first-color"></div>
		<div class="big-icon-second-color phone-callback-icon" data-toggle="tooltip" data-placement="right" data-original-title="Click here, please">
			<a>
                <!-- В ковычках в блоке src="" адрес к картинке -->
                <img src="images/ranepa-bot-button1.png" alt="Бот">
            </a>
		</div>
	</div>

	<div id="chat-bot-ms" style="">
		<div id="chat-bot-bg"></div>
        <div id="chatbot-container"></div>
	</div>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdn.botframework.com/botframework-webchat/latest/botchat.js"></script>
	<script>
		(function() {
            var model = {
              "userId": "6KtVTXeBzMm",
              "userName": "Вы",
              "botId": "Gumno_bot",
              "botIconUrl": "//bot-framework.azureedge.net/bot-icons-v1/bot-framework-default.png",
              "botName": "РАНХИГС-бот",
              "secret": "FJ0Xwo5jR9E.cwA.-UI.FwqfyABn0ih7LraltMnd5Qd7YIfKvX7keUzMShLjLyM",
              "iconUrl": "//bot-framework.azureedge.net/bot-icons-v1/bot-framework-default.png",
              "directLineUrl": "https://webchat.botframework.com/v3/directline",
              "webSocketEnabled": "false",
              "speechTokenEndpoint": "https://api.botframework.com/v3/speechtoken",
              "useLatestWebChat": false
            };

            BotChat.App({
                    directLine: {
                    secret: model.secret,
                    token: model.token,
                    domain: model.directLineUrl,
                    webSocket: false
                },
                user: { id: model.userId, name: model.userName },
                bot: { id: model.botId, name: model.botName },
            }, document.getElementById("chatbot-container"));

			var block = '#chat-bot-ms iframe';
			var block2 = '#chat-bot-ms #chat-bot-bg';
            var block3 = '#chatbot-container';

			var isOpen = false;
            var isScroll = true;

            function scrollChatbotWindow() {
                var scrolled = window.pageYOffset || document.documentElement.scrollTop;
                var position = scrolled - 95;
                $('#chat-bot-ms #chatbot-container').css('bottom', '-' + position + 'px');
                $('#chat-bot-ms #chat-bot-bg').css('bottom', '-' + position + 'px');
            }

			$(document).on('scroll', function(e) {
                if (isScroll) {
                    scrollChatbotWindow();
                }
			});

			$(document).ready(function() {
				$(document).on('click', '.phone-callback-icon', function() {
					var b = $(block);
					var b2 = $(block2);
					var b3 = $(block3);

					if (isOpen) {
						console.log('close');

						b3.css('opacity', 0);
						b3.css('width', 1);
						b3.css('height', 1);

						b2.css('display', 'none');

						isOpen = false;
					} else {

                        b3.css('opacity', 1);

                        if (window.innerWidth < 630) {
                            b3.css('width', window.innerWidth);
                            b3.css('height', window.innerHeight-90);
                            b2.css('width', window.innerWidth);
                            b2.css('height', window.innerHeight-90);
                        } else {
                            b3.css('width', 395);
                            b3.css('height', 580);
                            b2.css('width', 395);
                            b2.css('height', 580);
                        }

                        b2.css('display', 'block');
						isOpen = true;
					}
				});

                $(document).on('focus', 'input.wc-shellinput', function () {
                    if (window.innerWidth < 630) {
                        isScroll = false;
                    }
                });

                $(document).on('blur', 'input.wc-shellinput', function () {
                    if (window.innerWidth < 630) {
                        isScroll = true;
                        scrollChatbotWindow();
                    }
                });

                $(document).on('change', 'input.wc-shellinput', function () {
                    if (window.innerWidth < 630) {
                        isScroll = true;
                        scrollChatbotWindow();
                    }
                });


			});
		}());
	</script>
    <!-- THIS IS END FOR HTML-BLOCK IN THE PAGE.         ЭТО НАЧАЛО БЛОКА ДЛЯ ВСТАВКИ В HTML-блок страницы -->

</body>
</html>
